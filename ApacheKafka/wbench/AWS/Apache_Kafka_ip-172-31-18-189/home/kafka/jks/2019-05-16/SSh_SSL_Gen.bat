rem http://kafka.apache.org/documentation.html#security_ssl
rem ==========================================================================
rem Generate SSL key and certificate for each Kafka broker
rem ==========================================================================
D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore server.keystore.jks -storepass amu111 -alias localhost -validity 1000 -genkey -keyalg RSA
rem To add a SAN field append the following argument -ext SAN=DNS:{FQDN} to the keytool command:
rem D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore server.keystore.jks -storepass amu111 -alias localhost -validity 1000 -genkey -keyalg RSA -ext SAN=DNS:{FQDN}
rem D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore server.keystore.jks -storepass amu111 -alias localhost -validity 1000 -genkey -keyalg RSA -ext SAN=DNS:localhost
rem D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore server.keystore.jks -storepass amu111 -alias localhost -validity 1000 -genkey -keyalg RSA -ext SAN=ip:127.0.0.1
D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore server.keystore.jks -storepass amu111 -alias localhost -validity 1000 -genkey -keyalg RSA -ext SAN=DNS:localhost
rem The following command can be run afterwards to verify the contents of the generated certificate:
D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore server.keystore.jks -storepass amu111 -list -v 
rem ==========================================================================
rem Creating your own CA
rem ==========================================================================
D:\openssl\bin\openssl.exe req -new -x509 -keyout ca-key -out ca-cert -days 365 -config D:\openssl\share\openssl.cnf
rem The next step is to add the generated CA to the **clients' truststore** so that the clients can trust this CA:
D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore client.truststore.jks -storepass amu111 -alias CARoot -import -file ca-cert
rem Note: If you configure the Kafka brokers to require client authentication by setting ssl.client.auth to be "requested" or "required" 
rem on the Kafka brokers config then you must provide a truststore for the Kafka brokers as well and it should have all the CA certificates 
rem that clients' keys were signed by.
D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore server.truststore.jks -storepass amu111 -alias CARoot -import -file ca-cert

rem The next step is to sign all certificates generated by step 1 with the CA generated in step 
rem 2. First, you need to export the certificate from the keystore:
D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore server.keystore.jks -storepass amu111 -alias localhost -certreq -file cert-file
rem Then sign it with the CA:
D:\openssl\bin\openssl.exe x509 -req -CA ca-cert -CAkey ca-key -in cert-file -out cert-signed -days 1000 -CAcreateserial -passin pass:amu111

rem Finally, you need to import both the certificate of the CA and the signed certificate into the keystore:
D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore server.keystore.jks -storepass amu111 -alias CARoot -import -file ca-cert
D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore server.keystore.jks -storepass amu111 -alias localhost -import -file cert-signed

rem To check quickly if the server keystore and truststore are setup properly you can run the following command
D:\openssl\bin\openssl.exe s_client -debug -connect localhost:9093 -tls1



D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\bin\keytool.exe -keystore D:\user\miti\dev\trunk\External\jdk\jdk-1.8.0-x64\jre\lib\security\cacerts -storepass amu111 -alias CARoot -import -file ca-cert